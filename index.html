<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å­—éŸ³å­—å½¢äº’å‹•å°éŠæˆ²</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ¯ å­—éŸ³å­—å½¢äº’å‹•å°éŠæˆ²</h1>
    </div>
    <div class="game-setup" id="setup">
      <div class="setup-section">
        <h3>é¸æ“‡æŒ‘æˆ°æ™‚é–“</h3>
        <div class="button-group">
          <button class="setup-btn time-btn" data-time="120">2åˆ†é˜</button>
          <button class="setup-btn time-btn" data-time="180">3åˆ†é˜</button>
          <button class="setup-btn time-btn" data-time="300">5åˆ†é˜</button>
        </div>
      </div>
      <button class="setup-btn start-btn" id="startGame">é–‹å§‹éŠæˆ²</button>
    </div>
    <div class="game-area" id="gameArea">
      <div class="game-header">
        <div class="timer" id="timer">05:00</div>
        <div class="progress" id="progress">ç¬¬ 1 é¡Œ / 20 é¡Œ</div>
      </div>
      <div class="question-card" id="questionCard">
        <div class="question-type" id="questionType">å­—éŸ³é¡Œ</div>
        <div class="question-text" id="questionText">è«‹é¸æ“‡æ­£ç¢ºçš„æ³¨éŸ³</div>
        <div class="options-grid" id="optionsGrid"></div>
        <button class="next-btn" id="nextBtn">ä¸‹ä¸€é¡Œ</button>
      </div>
    </div>
    <div class="results" id="results">
      <h2>ğŸ‰ éŠæˆ²çµæŸï¼</h2>
      <div class="score-display" id="scoreDisplay">85åˆ†</div>
      <div class="results-grid">
        <div class="result-section">
          <h4>ä½œç­”çµæœ</h4>
          <div id="answerResults"></div>
        </div>
      </div>
      <button class="restart-btn" id="restartBtn">é‡æ–°é–‹å§‹</button>
    </div>
  </div>
  <script src="quiz.js"></script>
  <script>
    let gameState = {
      currentQuestions: [],
      currentQuestionIndex: 0,
      score: 0,
      timeLeft: 0,
      timer: null,
      userAnswers: []
    };
    const startBtn = document.getElementById('startGame');
    const gameArea = document.getElementById('gameArea');
    const setup = document.getElementById('setup');
    const results = document.getElementById('results');
    const nextBtn = document.getElementById('nextBtn');
    startBtn.addEventListener('click', () => {
      gameState.currentQuestions = shuffleArray([...quizData]).slice(0,20);
      gameState.currentQuestionIndex = 0;
      gameState.score = 0;
      gameState.userAnswers = [];
      gameState.timeLeft = 180;
      setup.style.display = 'none';
      gameArea.style.display = 'block';
      results.style.display = 'none';
      startTimer();
      showQuestion();
    });
    function showQuestion() {
      const q = gameState.currentQuestions[gameState.currentQuestionIndex];
      document.getElementById('progress').textContent = `ç¬¬ ${gameState.currentQuestionIndex+1} é¡Œ / ${gameState.currentQuestions.length} é¡Œ`;
      document.getElementById('questionText').textContent = q.q;
      document.getElementById('questionType').textContent = q.q.includes("æ³¨éŸ³") ? "å­—éŸ³é¡Œ" : "å­—å½¢é¡Œ";
      const optionsGrid = document.getElementById('optionsGrid');
      optionsGrid.innerHTML = '';
      q.options.forEach((opt, i) => {
        const btn = document.createElement('button');
        btn.className = 'option-btn';
        btn.textContent = opt;
        btn.onclick = () => selectAnswer(i);
        optionsGrid.appendChild(btn);
      });
      nextBtn.style.display = 'none';
    }
    function selectAnswer(selected) {
      const q = gameState.currentQuestions[gameState.currentQuestionIndex];
      const optionBtns = document.querySelectorAll('.option-btn');
      optionBtns.forEach((btn,i) => {
        btn.disabled = true;
        if (i === q.correct) btn.classList.add('correct');
        if (i === selected && i !== q.correct) btn.classList.add('incorrect');
      });
      if (selected === q.correct) gameState.score++;
      gameState.userAnswers.push({
        q: q.q,
        answer: q.options[selected],
        correct: q.options[q.correct],
        isCorrect: selected === q.correct
      });
      nextBtn.style.display = 'block';
    }
    nextBtn.addEventListener('click', () => {
      gameState.currentQuestionIndex++;
      if (gameState.currentQuestionIndex >= gameState.currentQuestions.length) {
        endGame();
      } else {
        showQuestion();
      }
    });
    function endGame() {
      clearInterval(gameState.timer);
      gameArea.style.display = 'none';
      results.style.display = 'block';
      const scorePercent = Math.round((gameState.score/gameState.currentQuestions.length)*100);
      document.getElementById('scoreDisplay').textContent = `${scorePercent}åˆ†`;
      const answerResults = document.getElementById('answerResults');
      answerResults.innerHTML = '';
      gameState.userAnswers.forEach((ans,i)=>{
        const div = document.createElement('div');
        div.className = 'answer-item';
        div.innerHTML = `ç¬¬${i+1}é¡Œï¼š${ans.isCorrect ? "âœ…" : "âŒ"} æ­£è§£ï¼š${ans.correct}`;
        answerResults.appendChild(div);
      });
    }
    function startTimer(){
      gameState.timer = setInterval(()=>{
        gameState.timeLeft--;
        const m = String(Math.floor(gameState.timeLeft/60)).padStart(2,'0');
        const s = String(gameState.timeLeft%60).padStart(2,'0');
        document.getElementById('timer').textContent = `${m}:${s}`;
        if(gameState.timeLeft<=0) endGame();
      },1000);
    }
    function shuffleArray(arr){ return arr.sort(()=>Math.random()-0.5); }
    document.getElementById('restartBtn').addEventListener('click',()=>{
      results.style.display = 'none';
      setup.style.display = 'block';
    });
  </script>
</body>
</html>